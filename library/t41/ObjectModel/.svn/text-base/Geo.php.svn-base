<?php

/**
 * t41 Toolkit
 *
 * LICENSE
 *
 * This source file is subject to the new BSD license that is bundled
 * with this package in the file LICENSE.txt.
 * It is also available through the world-wide-web at this URL:
 * http://www.t41.org/license/new-bsd
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@t41.org so we can send you a copy immediately.
 *
 * @category   t41
 * @package    t41_Core
 * @copyright  Copyright (c) 2006-2011 Quatrain Technologies SARL
 * @license    http://www.t41.org/license/new-bsd     New BSD License
 * @version    $Revision$
 */

/** t41_Object abstract class */
require_once 't41/Object.php';

/**
 * Classe abstraite proposant les fondations pour le dï¿½veloppement d'objets gï¿½olocalisï¿½s
 * 
 * @category t41
 * @package t41_Geo
 * @copyright Copyright (c) 2006-2009 Quatrain Technologies SARL, France
 * @license http://t41.quatrain.com/license/new-bsd     New BSD License
 * @version $Revision$ 
 *
 */
abstract class t41_Object_Geo extends t41_Object {

	
	/**
	 * Address object
	 *
	 * @var t41_Geo_Address
	 */
	protected $_address;
	
	/**
	 * Coordinates object
	 *
	 * @var t41_Geo_Coord
	 */
	protected $_coord;
	
	

	
	
	protected function _getDataFromId($id) {
		
		parent::_getDataFromId($id);
	}
	
	
	/**
	 * Returns an instance of t41_Coord
	 *
	 * @return t41_Coord
	 */
	public function getCoord() {
		
		if (! $this->_coord instanceof t41_Coord ) {

			$this->getAddress();
			
			$params = $this->_params;
			$params['address'] = $this->_address->__toString();
			
			$this->_coord = new t41_Geo_Coord($this->_id, $params, $this->_table);
			
			$this->_coord->setAddress($this->_address);
			//var_dump($this->_coord->getLatLng());
		}
		
		return $this->_coord;
	}
	
	
	public function getAddress() {

		if (! $this->_address instanceof t41_Geo_Address ) {
			$address = new t41_Geo_Address($this->_id, $this->_params, $this->_table);
			
			$this->_address = $address;
		}
		
		return $this->_address;
	}

}